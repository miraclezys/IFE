<!DOCTYPE html>
<html>
<head>
	<title>Task01</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="./css/task01.css">
</head>
<body>
	<form>
		<table>
		<tr>
			<td><label for="name-1">名称</label></td>
			<td><input id="text-1" type="text"></td>
			<td><input type="button" id="button-1" value="验证"></td>
		</tr>
		<tr>
			<td></td>
			<td><p id="hint-1">必填，长度为4~16字符</p></td>
			<td></td>
		</tr>
		<tr>
			<td><label for="name-2">名称</label></td>
			<td><input id="text-2" type="text"></td>
			<td><input type="button" id="button-2" value="验证"></td>
		</tr>
		<tr>
			<td></td>
			<td><p id="hint-2">必填，长度为4~16字符</p></td>
			<td></td>
		</tr>
		<tr>
			<td><label for="name-3">名称</label></td>
			<td><input id="text-3" type="text"></td>
			<td><input type="button" id="button-3" value="验证"></td>
		</tr>
		<tr>
			<td></td>
			<td><p id="hint-3">必填，长度为4~16字符</p></td>
			<td></td>
		</tr>
		</table>
	</form>
</body>
<script type="text/javascript">
	function test (i) {
		var text = document.getElementById("text-" + i).value;
		var button = document.getElementById("button-" + i);
		var hint = document.getElementById("hint-" + i);
		if(text == "") {
			hint.innerHTML = "<span class='warning'>姓名不能为空</span>";
			document.getElementById("text-" + i).style.border = "1px solid #DC0115";
		}
		else if(getLength(text) < 4 || getLength(text) > 16) {
			hint.innerHTML = "<span class='warning'>长度不对哦，名字长度为4~16字符</span>";
			document.getElementById("text-" + i).style.border = "1px solid #DC0115";
		}
		else {
			hint.innerHTML = "<span class='good'>名称格式正确</span>";
			document.getElementById("text-" + i).style.border = "1px solid #61BE49";
		}
	}

	function getLength (text) {
		var len = 0;
		for(var i=0; i<text.length; i++) {
			if(text.charAt(i).match(/[^\x00-\xff]/ig) != null) {
				len += 2;
			}
			else {
				len += 1;
			}
		}
		return len;
	}

	function addListener (i) {
		var button = document.getElementById("button-" + i);
		button.addEventListener('click', function() {
			test(i);
		});
	}

	function init () {
		for(var i=1; i<=3; i++) {
			addListener(i);
		}
	}
	
	init();

</script>
</html>